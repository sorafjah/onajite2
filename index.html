<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãŠãªã˜ã‚‚ã®ã‚’ã ãã†</title>
    <!-- Tailwind CSSã‚’èª­ã¿è¾¼ã¿ã¾ã™ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ãƒ•ã‚©ãƒ³ãƒˆã‚’èª­ã¿è¾¼ã¿ã¾ã™ */
        @import url('https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@700&display=swap');
        body {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            touch-action: manipulation; /* ãƒ€ãƒ–ãƒ«ã‚¿ãƒƒãƒ—ã«ã‚ˆã‚‹ã‚ºãƒ¼ãƒ ã‚’ç„¡åŠ¹åŒ– */
        }
        /* ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯æ™‚ã®è¦–è¦šçš„ãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ */
        .btn-active:active {
            transform: scale(0.95);
        }
        /* æ‰‹ã®çµµæ–‡å­—ãŒåˆ‡ã‚Šæ›¿ã‚ã‚‹éš›ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        .hand-emoji {
            transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .hand-emoji.pop {
            transform: scale(1.2);
        }
        /* ãƒœã‚¿ãƒ³ã‚„Selectã‚’ç„¡åŠ¹åŒ–ï¼ˆdisabledï¼‰ã—ãŸã¨ãã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .btn-disabled:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: scale(1); /* activeæ™‚ã®ç¸®å°ã‚’ç„¡åŠ¹åŒ– */
        }
        /* Selectè¦ç´ ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¹ã‚¿ã‚¤ãƒ«ã‚’ä¸Šæ›¸ã */
        select.btn-active {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            /* çŸ¢å°ã®ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆTailwindã®è‰² (teal-500) ã«åˆã‚ã›ã¦èª¿æ•´ï¼‰ */
            background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path stroke="%23FFFFFF" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M6 8l4 4 4-4"/></svg>');
            background-position: right 0.75rem center; /* å³å¯„ã› */
            background-repeat: no-repeat;
            background-size: 1.25em 1.25em;
            padding-right: 2.5rem; /* çŸ¢å°ã®ã‚¹ãƒšãƒ¼ã‚¹ã‚’ç¢ºä¿ */
        }
        /* disabledæ™‚ã®çŸ¢å° */
        select.btn-disabled:disabled {
             background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path stroke="%23FFFFFF" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M6 8l4 4 4-4" opacity="0.5"/></svg>');
        }
    </style>
</head>
<body class="bg-sky-100 flex items-center justify-center h-screen p-4">

    <div class="w-full max-w-2xl mx-auto bg-white/30 backdrop-blur-xl rounded-3xl shadow-2xl p-6 md:p-8 text-center">
        
        <!-- æ‰‹ã‚’è¡¨ç¤ºã™ã‚‹ã‚¨ãƒªã‚¢ -->
        <div class="flex justify-center items-center space-x-4 md:space-x-8 mb-8">
            <div class="bg-white rounded-2xl shadow-lg w-40 h-40 md:w-64 md:h-64 flex items-center justify-center">
                <span id="hand-left-emoji" class="text-8xl md:text-[10rem] hand-emoji"></span>
            </div>
            <div class="bg-white rounded-2xl shadow-lg w-40 h-40 md:w-64 md:h-64 flex items-center justify-center">
                <span id="hand-right-emoji" class="text-8xl md:text-[10rem] hand-emoji"></span>
            </div>
        </div>

        <!-- ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ (gap-y-3ã§ç¸¦ã®éš™é–“ã‚‚è¨­å®š) -->
        <div class="flex flex-col sm:flex-row flex-wrap justify-center items-center gap-x-3 gap-y-3">
            <!-- ã€Œã‚¹ã‚¿ãƒ¼ãƒˆã€/ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ -->
            <button id="game-button" class="w-full sm:w-auto bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-6 rounded-full text-base shadow-md transition-all duration-200 btn-active btn-disabled">
                ã‚¹ã‚¿ãƒ¼ãƒˆ
            </button>
            <!-- ã€Œè‡ªå‹•ã€/ã€Œåœæ­¢ã€ãƒœã‚¿ãƒ³ -->
            <button id="auto-button" class="w-full sm:w-auto bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-6 rounded-full text-base shadow-md transition-all duration-200 btn-active btn-disabled">
                è‡ªå‹•
            </button>
            <!-- ã€Œã‚‚ã£ã¨ã€/ã€Œãµã¤ã†ã€ãƒœã‚¿ãƒ³ -->
            <button id="more-button" class="w-full sm:w-auto bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-6 rounded-full text-base shadow-md transition-all duration-200 btn-active btn-disabled">
                ã‚‚ã£ã¨
            </button>
            
            <!-- (ã“ã“ã‹ã‚‰è¿½åŠ ) é€Ÿåº¦é¸æŠãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ -->
            <!-- px-6ã ã¨çŸ¢å°ã¨è¢«ã‚‹ãŸã‚ã€padding-leftã§èª¿æ•´ -->
            <select id="speed-select" class="w-full sm:w-auto bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 pl-6 pr-10 rounded-full text-base shadow-md transition-all duration-200 btn-active btn-disabled focus:outline-none focus:ring-2 focus:ring-teal-400">
                <!-- optionã®æ–‡å­—è‰²ã¯CSSã§åˆ¶å¾¡ã—ã«ãã„å ´åˆãŒã‚ã‚‹ãŸã‚ã€èƒŒæ™¯è‰²ã§å¯¾å¿œ -->
                <option value="auto" class="bg-white text-black">2ç§’ã¨5ç§’</option>
                <option value="2000" class="bg-white text-black">ï¼’ç§’ã”ã¨</option>
                <option value="5000" class="bg-white text-black">ï¼•ç§’ã”ã¨</option>
                <option value="10000" class="bg-white text-black">ï¼‘ï¼ç§’ã”ã¨</option>
            </select>
            <!-- (ã“ã“ã¾ã§è¿½åŠ ) -->

        </div>
    </div>

    <script>
        // --- DOMè¦ç´ ã®å–å¾— ---
        const gameButton = document.getElementById('game-button');
        const autoButton = document.getElementById('auto-button');
        const moreButton = document.getElementById('more-button');
        const speedSelect = document.getElementById('speed-select'); // è¿½åŠ 
        const leftHandEmoji = document.getElementById('hand-left-emoji');
        const rightHandEmoji = document.getElementById('hand-right-emoji');

        // --- ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹ ---
        const hands = ['âœŠ', 'âœŒï¸', 'âœ‹'];
        const irregularHands = ['ğŸ¤', 'ğŸ¤Ÿ', 'ğŸ¤˜', 'ğŸ¤™', 'ğŸ‘Œ', 'ğŸ––'];
        let isGameStarted = false;
        let autoPlayTimeoutId = null; // è‡ªå‹•å†ç”Ÿã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆID
        let isMoreMode = false; // ã€Œã‚‚ã£ã¨ã€ãƒ¢ãƒ¼ãƒ‰ã®çŠ¶æ…‹ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯falseï¼‰

        // --- ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ ---
        gameButton.addEventListener('click', handleManualPlay);
        autoButton.addEventListener('click', toggleAutoPlay);
        moreButton.addEventListener('click', toggleMoreMode);

        /**
         * ã€Œã‚¹ã‚¿ãƒ¼ãƒˆã€/ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã¨ãã®å‡¦ç†
         */
        function handleManualPlay() {
            if (!isGameStarted) {
                isGameStarted = true;
                gameButton.textContent = 'æ¬¡ã¸';
            }
            generateAndShowHands();
        }

        /**
         * ã€Œè‡ªå‹•ã€/ã€Œåœæ­¢ã€ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã¨ãã®å‡¦ç†
         */
        function toggleAutoPlay() {
            // è‡ªå‹•å†ç”ŸãŒæ—¢ã«å®Ÿè¡Œä¸­ã®å ´åˆï¼ˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆIDãŒå­˜åœ¨ã™ã‚‹å ´åˆï¼‰
            if (autoPlayTimeoutId) {
                clearTimeout(autoPlayTimeoutId);
                autoPlayTimeoutId = null;
                autoButton.textContent = 'è‡ªå‹•';
                autoButton.classList.remove('bg-gray-400', 'hover:bg-gray-500');
                autoButton.classList.add('bg-teal-500', 'hover:bg-teal-600');
                gameButton.disabled = false; // ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
                moreButton.disabled = false; // ã€Œã‚‚ã£ã¨ã€ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
                speedSelect.disabled = false; // (è¿½åŠ ) é€Ÿåº¦é¸æŠã‚’æœ‰åŠ¹åŒ–
            } else {
                // è‡ªå‹•å†ç”Ÿã‚’é–‹å§‹
                if (!isGameStarted) {
                    isGameStarted = true;
                    gameButton.textContent = 'æ¬¡ã¸';
                }
                autoButton.textContent = 'åœæ­¢';
                autoButton.classList.remove('bg-teal-500', 'hover:bg-teal-600');
                autoButton.classList.add('bg-gray-400', 'hover:bg-gray-500');
                gameButton.disabled = true; // ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
                moreButton.disabled = true; // ã€Œã‚‚ã£ã¨ã€ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
                speedSelect.disabled = true; // (è¿½åŠ ) é€Ÿåº¦é¸æŠã‚’ç„¡åŠ¹åŒ–
                autoPlayStep(); // è‡ªå‹•å†ç”Ÿã®ãƒ«ãƒ¼ãƒ—ã‚’é–‹å§‹
            }
        }

        /**
         * ã€Œã‚‚ã£ã¨ã€/ã€Œãµã¤ã†ã€ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã¨ãã®å‡¦ç†
         */
        function toggleMoreMode() {
            isMoreMode = !isMoreMode; // çŠ¶æ…‹ã‚’åè»¢

            if (isMoreMode) {
                moreButton.textContent = 'ãµã¤ã†';
                moreButton.classList.remove('bg-teal-500', 'hover:bg-teal-600');
                moreButton.classList.add('bg-gray-400', 'hover:bg-gray-500');
            } else {
                moreButton.textContent = 'ã‚‚ã£ã¨';
                moreButton.classList.remove('bg-gray-400', 'hover:bg-gray-500');
                moreButton.classList.add('bg-teal-500', 'hover:bg-teal-600');
            }
        }

        /**
         * è‡ªå‹•å†ç”Ÿã®å„ã‚¹ãƒ†ãƒƒãƒ—ã‚’å®Ÿè¡Œã™ã‚‹ (ä¿®æ­£)
         */
        function autoPlayStep() {
            const wasIrregular = generateAndShowHands();
            
            // (ã“ã“ã‹ã‚‰ä¿®æ­£) é¸æŠã•ã‚Œã¦ã„ã‚‹é€Ÿåº¦ã‚’å–å¾—
            const selectedSpeed = speedSelect.value; // 'auto', '2000', '5000', ...
            let delay;

            if (selectedSpeed === 'auto') {
                // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®å‹•ä½œï¼ˆã‚¤ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼ãªã‚‰5ç§’ã€é€šå¸¸ãªã‚‰2ç§’ï¼‰
                delay = wasIrregular ? 5000 : 2000;
            } else {
                // å›ºå®šé€Ÿåº¦ãŒé¸æŠã•ã‚Œã¦ã„ã‚‹å ´åˆ
                delay = parseInt(selectedSpeed, 10);
            }
            // (ã“ã“ã¾ã§ä¿®æ­£)
            
            autoPlayTimeoutId = setTimeout(autoPlayStep, delay);
        }
        
        /**
         * isMoreModeã®çŠ¶æ…‹ã«å¿œã˜ã¦ã€ãƒ©ãƒ³ãƒ€ãƒ ãªæ‰‹ã‚’1ã¤è¿”ã™
         * @returns {string} çµµæ–‡å­—
         */
        function getRandomHand() {
            // ã€Œã‚‚ã£ã¨ã€ãƒ¢ãƒ¼ãƒ‰ãŒtrueã®å ´åˆã®ã¿ã€10%ã®ç¢ºç‡ã§ã‚¤ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼ãªæ‰‹ã‚’è€ƒæ…®
            if (isMoreMode && Math.random() < 0.1) {
                const randomIndex = Math.floor(Math.random() * irregularHands.length);
                return irregularHands[randomIndex];
            } else {
                const randomIndex = Math.floor(Math.random() * hands.length);
                return hands[randomIndex];
            }
        }

        /**
         * ãƒ©ãƒ³ãƒ€ãƒ ã«æ‰‹ã‚’ç”Ÿæˆã—ã¦ç”»é¢ã«è¡¨ç¤ºã™ã‚‹
         */
        function generateAndShowHands() {
            const leftHand = getRandomHand();
            const rightHand = getRandomHand();

            const wasIrregular = irregularHands.includes(leftHand) || irregularHands.includes(rightHand);

            [leftHandEmoji, rightHandEmoji].forEach(el => {
                el.classList.remove('pop');
                void el.offsetWidth;
                el.classList.add('pop');
            });
            
            setTimeout(() => {
                leftHandEmoji.textContent = leftHand;
                rightHandEmoji.textContent = rightHand;
            }, 100);

            return wasIrregular;
        }

        // æœ€åˆã®è¡¨ç¤º
        generateAndShowHands();
    </script>

</body>
</html>
