<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>おなじものをだそう２</title>
    <!-- Tailwind CSSを読み込みます -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* フォントを読み込みます */
        @import url('https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@700&display=swap');
        body {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            touch-action: manipulation; /* ダブルタップによるズームを無効化 */
        }
        /* ボタンのクリック時の視覚的なフィードバック */
        .btn-active:active {
            transform: scale(0.95);
        }
        /* 手の絵文字が切り替わる際のアニメーション */
        .hand-emoji {
            transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .hand-emoji.pop {
            transform: scale(1.2);
        }
    </style>
</head>
<body class="bg-sky-100 flex items-center justify-center h-screen p-4">

    <div class="w-full max-w-2xl mx-auto bg-white/30 backdrop-blur-xl rounded-3xl shadow-2xl p-6 md:p-10 text-center">
        <h1 class="text-3xl md:text-5xl font-bold text-blue-600 text-shadow mb-8">おなじものをだそう２</h1>

        <!-- 手を表示するエリア -->
        <div class="flex justify-center items-center space-x-4 md:space-x-8 mb-10">
            <div class="bg-white rounded-2xl shadow-lg w-32 h-32 md:w-48 md:h-48 flex items-center justify-center">
                <span id="hand-left-emoji" class="text-6xl md:text-8xl hand-emoji"></span>
            </div>
            <div class="bg-white rounded-2xl shadow-lg w-32 h-32 md:w-48 md:h-48 flex items-center justify-center">
                <span id="hand-right-emoji" class="text-6xl md:text-8xl hand-emoji"></span>
            </div>
        </div>

        <!-- ボタンエリア -->
        <div class="flex flex-col sm:flex-row justify-center items-center gap-4">
            <button id="game-button" class="w-full sm:w-auto bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 px-10 rounded-full text-xl md:text-2xl shadow-md transition-all duration-200 btn-active">
                スタート
            </button>
            <button id="auto-button" class="w-full sm:w-auto bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-10 rounded-full text-xl md:text-2xl shadow-md transition-all duration-200 btn-active">
                自動
            </button>
        </div>
    </div>

    <script>
        // --- DOM要素の取得 ---
        const gameButton = document.getElementById('game-button');
        const autoButton = document.getElementById('auto-button');
        const leftHandEmoji = document.getElementById('hand-left-emoji');
        const rightHandEmoji = document.getElementById('hand-right-emoji');

        // --- ゲームの状態 ---
        const hands = ['✊', '✌️', '✋'];
        const irregularHands = ['🤞', '🤟', '🤘', '🤙', '👌', '🖖'];
        let isGameStarted = false;
        let autoPlayTimeoutId = null; // 自動再生のタイムアウトID

        // --- イベントリスナー ---
        gameButton.addEventListener('click', handleManualPlay);
        autoButton.addEventListener('click', toggleAutoPlay);

        /**
         * 「スタート」/「次へ」ボタンがクリックされたときの処理
         */
        function handleManualPlay() {
            if (!isGameStarted) {
                isGameStarted = true;
                gameButton.textContent = '次へ';
            }
            generateAndShowHands();
        }

        /**
         * 「自動」/「停止」ボタンがクリックされたときの処理
         */
        function toggleAutoPlay() {
            // 自動再生が既に実行中の場合（タイムアウトIDが存在する場合）
            if (autoPlayTimeoutId) {
                clearTimeout(autoPlayTimeoutId);
                autoPlayTimeoutId = null;
                autoButton.textContent = '自動';
                autoButton.classList.remove('bg-orange-400', 'hover:bg-orange-500');
                autoButton.classList.add('bg-green-500', 'hover:bg-green-600');
                gameButton.disabled = false; // 「次へ」ボタンを有効化
            } else {
                // 自動再生を開始
                if (!isGameStarted) {
                    isGameStarted = true;
                    gameButton.textContent = '次へ';
                }
                autoButton.textContent = '停止';
                autoButton.classList.remove('bg-green-500', 'hover:bg-green-600');
                autoButton.classList.add('bg-orange-400', 'hover:bg-orange-500');
                gameButton.disabled = true; // 「次へ」ボタンを無効化
                autoPlayStep(); // 自動再生のループを開始
            }
        }

        /**
         * 自動再生の各ステップを実行する
         */
        function autoPlayStep() {
            const wasIrregular = generateAndShowHands();
            const delay = wasIrregular ? 3000 : 2000; // イレギュラーなら3秒、通常なら2秒
            autoPlayTimeoutId = setTimeout(autoPlayStep, delay);
        }
        
        /**
         * 10%の確率でイレギュラーな手を考慮し、ランダムな手を1つ返す
         * @returns {string} 絵文字
         */
        function getRandomHand() {
            const isIrregular = Math.random() < 0.1; // 10%の確率
            if (isIrregular) {
                const randomIndex = Math.floor(Math.random() * irregularHands.length);
                return irregularHands[randomIndex];
            } else {
                const randomIndex = Math.floor(Math.random() * hands.length);
                return hands[randomIndex];
            }
        }

        /**
         * ランダムに手を生成して画面に表示する
         */
        function generateAndShowHands() {
            const leftHand = getRandomHand();
            const rightHand = getRandomHand();

            const wasIrregular = irregularHands.includes(leftHand) || irregularHands.includes(rightHand);

            // アニメーション効果を適用
            [leftHandEmoji, rightHandEmoji].forEach(el => {
                el.classList.remove('pop');
                // DOMの再描画を強制
                void el.offsetWidth;
                el.classList.add('pop');
            });
            
            // アニメーションが少し落ち着いてから絵文字を変更
            setTimeout(() => {
                leftHandEmoji.textContent = leftHand;
                rightHandEmoji.textContent = rightHand;
            }, 100);

            return wasIrregular;
        }
    </script>

</body>
</html>



